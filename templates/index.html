<!doctype html>
<html>
<body style="background:#0f172a;color:#e6eef6;font-family:Arial;padding:20px;">
  <h2>Telegram WebApp debug</h2>
  <pre id="out">loadingâ€¦</pre>
  <script>
    try {
      const tg = window.Telegram?.WebApp || null;
      const unsafe = tg?.initDataUnsafe || null;
      const startParamFromUrl = new URLSearchParams(location.search).get('startapp') || null;
      const info = {
        hasWebApp: !!tg,
        initDataUnsafe: unsafe,
        start_param_from_initData: unsafe?.start_param ?? null,
        start_param_from_url: startParamFromUrl
      };
      document.getElementById('out').textContent = JSON.stringify(info, null, 2);

      // optional: send debug to server
      fetch('/debug_client', { method:'POST', headers:{'content-type':'application/json'}, body: JSON.stringify(info) }).catch(()=>{});
    } catch(e) {
      document.getElementById('out').textContent = 'error: ' + e.message;
    }
  </script>
</body>
</html>
